<!DOCTYPE html>

<!--[if lt IE 9]><html class="lte-ie8" lang="en"><![endif]-->
<!--[if gt IE 8]><!-->
<html lang="en">
<!--<![endif]-->

<head>
        <!--    Load CSS elements-->
    <link rel=stylesheet type=text/css href="{{ url_for('static', filename='lib/css/spotlight.css') }}">
    <!-- <link rel=stylesheet type=text/css href="{{ url_for('static', filename='lib/css/fonts.css') }}"> -->
    <link rel=stylesheet type=text/css href="{{ url_for('static', filename='lib/css/govuk-template.css') }}">
    <!-- <link rel=stylesheet type=text/css href="{{ url_for('static', filename='lib/css/bootstrap.min.css') }}"> -->
    <link rel=stylesheet type=text/css href="{{ url_for('static', filename='lib/css/dc.css') }}">
    <!-- <link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/custom.css') }}"> -->
    <!-- <link rel=stylesheet type=text/css href="{{ url_for('static', filename='lib/css/govuk-template-print.css') }}"> -->
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <link rel="shortcut icon" href="{{ url_for('static', filename='img/favicon.ico') }}" type="image/x-icon" />
    
    <title>GOV.UK Verify Local Dashboard</title>
    
 <!--Load Javascript files-->
    <script type="text/javascript">
    /*global navigator*/
        (function () {
            if (navigator.userAgent.match(/IEMobile\/10\.0/)) {
                var d = document,
                    c = "appendChild",
                    a = d.createElement("style");
                a[c](d.createTextNode("@-ms-viewport{width:auto!important}"));
                d.getElementsByTagName("head")[0][c](a);
            }
        })();
    </script>
    
    <script src="{{ url_for('static', filename='lib/js/jquery.min.js') }}"></script>
    <script src="{{ url_for('static', filename='lib/js/bootstrap.min.js') }}"></script>
    <script src="{{ url_for('static', filename='lib/js/govuk-template.js') }}"></script>
    <script src="{{ url_for('static', filename='lib/js/crossfilter.js') }}"></script>
    <script src="{{ url_for('static', filename='lib/js/d3.js') }}"></script>
    <script src="{{ url_for('static', filename='lib/js/dc.js') }}"></script>
    <script src="{{ url_for('static', filename='lib/js/keen.min.js') }}"></script>
    <!-- <script src="{{ url_for('static', filename='js/graphs.js') }}"></script> -->

    

</head>



<body>
<!-- start header -->
<header role="banner" id="global-header" class="with-proposition">
    <div class="header-wrapper">
        <div class="header-global">
            <div class="header-logo">
                <a href="https://www.gov.uk/" title="Go to the GOV.UK homepage" id="logo" class="content">
                        GOV.UK
                    </a>
            </div>
        </div>
        <div class="header-proposition">
            <div class="content">
                <nav id="proposition-menu" role="navigation">
                    <a href="https://www.gov.uk/performance" id="proposition-name">Performance</a>
                    <span class="beta-tag">Beta</span>
                    <a href="#proposition-links" class="js-header-toggle menu">Menu</a>
                    <ul id="proposition-links">
                        <li><a href="https://www.gov.uk/performance/services">Service dashboards</a>
                        </li>
                        <li><a href="http://performance-platform.readthedocs.org/">Get a dashboard</a>
                        </li>
                        <li><a href="https://www.gov.uk/performance/about">About</a>
                        </li>
                        <li><a href="https://www.gov.uk/performance/prototypes">Prototypes</a>
                        </li>
                        <li><a href="https://gdsdata.blog.gov.uk/">Blog</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>

    </div>
</header>
<!--end header-->

<div id="global-header-bar">
    <div class="inner-block">
        <div class="header-bar"></div>
    </div>
</div>
<!--end global-header-bar-->

<div id="wrapper">
    <main id="content" class="group" role="main">




        <body class="application">
        <header class="page-header">
    <div>
        <h2 class="heading-large">Service[service name] Dashboard for LA [LA name]</h2>

    </div>
</header>
<p class="lede">
  Charts showing the performance  data for users of GOV.UK Verify Local Authority 
</p>


            
           
            <div class="col-md-5">
                            <div class="chart-wrapper">
                                <!-- <div class="chart-stage"> -->
                                    <div id="test">
                                        <div class="titling">
                                            #VerifyLocal [Service] performance dashboard				
                                            <span class='reset' style='visibility: visible;'>
                                                Selected: <span class='filter'></span>
                                            <a class='reset' href='javascript:dc.filterAll();dc.redrawAll();'>Reset all filters</a>
                                            
                                            <!-- <a href="javascript:barChartAge.filterAll();dc.redrawAll();">reset</a> -->
                                        
                                            </span>
                                        </div>
                                    </div>
                                    </div>
                                    

                            <!-- </div> -->
                        </div>  


</main>
<script type="text/javascript">
var chart = dc.seriesChart("#test");
var ndx, runDimension, runGroup;
d3.csv("static/data/test.csv", function(error, experiments) {
    console.log(experiments)

	var dateFormat = d3.time.format("%Y-%m-%d");
    var numberFormat = d3.format(",d");
	experiments.forEach(function (d) {
	d["Expt"] = dateFormat.parse(d["Expt"]);
	}); 

  ndx = crossfilter(experiments);
  runDimension = ndx.dimension(function(d) {return [d.Expt, d.Run]; });
  runGroup = runDimension.group().reduceSum(function(d) { return +d.Speed; });

  var timeDim = ndx.dimension(function (d) {
        return d3.time.week(d["Expt"]);
    });

   var minTime = timeDim.bottom(1)[0]["Expt"];
   var maxTime = timeDim.top(1)[0]["Expt"];


  chart
    .width(768)
    .height(480)
    .chart(function(c) { return dc.lineChart(c).interpolate('basis'); })
    .x(d3.scale.linear().domain([minTime,maxTime]))
    .brushOn(false)
    .yAxisLabel("Measured Speed km/s")
    .xAxisLabel("Run")
    .clipPadding(10)
    .elasticY(true)
    .dimension(runDimension)
    .group(runGroup)
    .mouseZoomable(true)
    .seriesAccessor(function(d) {
    	return "Expt: " + d.key[0];
    })
    .keyAccessor(function(d) {
    	return d.key[1];
    })
    .valueAccessor(function(d) {
    	return +d.value - 500;
    })
    .legend(dc.legend().x(350).y(350).itemHeight(13).gap(5).horizontal(1).legendWidth(140).itemWidth(70));
  chart.yAxis().tickFormat(function(d) {return d3.format(',d')(d+299500);});
  chart.margins().left += 40;
  dc.renderAll();
});
// function load_button(file) {
//     return function load_it() {
//         d3.csv(file, function(error, experiments) {
//             ndx.remove();
//             ndx.add(experiments);
//             dc.redrawAll();
//         });
//     };
// }
// var button1 = load_button("morley.csv"),
//     button2 = load_button("morley2.csv"),
//     button3 = load_button("morley3.csv");
</script>

</div>
</body>


<!--end footer-->
<div class="modal"><!-- Place at bottom of page --></div>

</body>

</html>